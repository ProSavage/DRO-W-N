<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>TrojanRescues</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/bar.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>
    <script src="js/pace.min.js"></script>


    <link rel="shortcut icon" href="images/rescues.ico" type="image/x-icon">
    <link rel="icon" href="images/rescues.ico" type="image/x-icon">

</head>

<body id="top">

<!-- header
================================================== -->
<header class="s-header">

    <div class="header-logo">
        <p class="site-logos" href="index.html">
            <img src="images/logo.jpg" alt="Homepage" id="logo" style="margin-top: 75px"/>
        </a>
    </div>

    <nav class="header-nav">

        <a href="#0" class="header-nav__close" title="close"><span>Close</span></a>

        <div class="header-nav__content">
            <h3>Navigation</h3>

            <ul class="header-nav__list">
                <li class="current"><a class="smoothscroll"  href="#home" title="home">Home</a></li>
                <li><a class="smoothscroll" href="#solution" title="solution">Code</a></li>
            </ul>

        </div> <!-- end header-nav__content -->

    </nav>  <!-- end header-nav -->

    <a class="header-menu-toggle" href="#0">
        <span class="header-menu-text">Menu</span>
        <span class="header-menu-icon"></span>
    </a>

</header> <!-- end s-header -->


<!-- home
================================================== -->
<section id="home" class="s-home target-section" data-parallax="scroll" data-image-src="images/hero-bg.jpg" data-natural-width=3000 data-natural-height=2000 data-position-y=center>

    <div class="overlay"></div>
    <div class="shadow-overlay"></div>

    <div class="home-content">

        <div class="row home-content__main">

            <h3>ABOUT DRO(W)N</h3>

            <h1>
                It is a Drone Surveillance system which detects the drowning person in the beaches and
                releases the life jacket to them.

            </h1>

        </div>

        <div class="home-content__scroll">
            <a href="#about" class="scroll-link smoothscroll">
                <span>Scroll Down</span>
            </a>
        </div>

        <div class="home-content__line"></div>

    </div> <!-- end home-content -->


</section> <!-- end s-home -->

<!-- code
================================================== -->
<section id="solution" class="s-clients">

    <div class="row section-header" data-aos="fade-up">
        <div class="col-full">
            <h3 class="subhead">Our Code</h3>
            <h1 class="display-2">Take a look at our technology.</h1>
        </div>

        <h2>Pose Recognizer Model</h2>
        <button type="button" onclick="poseInit()">Start</button>
        <div><canvas id="capture"></canvas></div>
        <div id="pose-label-container"></div>
        <button style="margin-top: 20px" type="button" onclick="stopPose()">Stop</button>

        <h2 style="margin-top: 20%">Drowning Detection</h2>
        <video width="1920" height="1080" controls>
            <source src="videos/finaldive.mp4" type="video/mp4">
        </video>

    </div> <!-- end section-header -->

    <div class="row clients-outer" data-aos="fade-up">
        <div class="col-full">
            <div class="clients">

                <a href="#0" title="" class="clients__slide"><img src="images/clients/python.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/apple.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/android.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/JS.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/machine_learning.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/css.png" /></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/html-512.png"/></a>
                <a href="#0" title="" class="clients__slide"><img src="images/clients/ubuntu.png" /></a>

            </div> <!-- end clients -->
        </div> <!-- end col-full -->
    </div> <!-- end clients-outer -->
</section> <!-- end s-clients -->

<!-- footer
================================================== -->
<footer>

    <div class="row footer-main">

        <div class="tab-full footer-desc">

            <div class="footer-logo"></div>

        </div>

    </div> <!-- end footer-main -->

    <div class="row footer-bottom">

        <div class="col-twelve">
            <div class="go-top">
                <a class="smoothscroll" title="Back to Top" href="#top"><i class="icon-arrow-up" aria-hidden="true"></i></a>
            </div>
        </div>

    </div> <!-- end footer-bottom -->
    <p> &copy 2020 !DROWN. All rights reserved! </p>

</footer> <!-- end footer -->


<!-- photoswipe background
================================================== -->
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">

    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">

        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title=
                    "Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title=
                    "Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title=
                "Next (arrow right)"></button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>

    </div>

</div> <!-- end photoSwipe background -->


<!-- preloader
================================================== -->
<div id="preloader">
    <div id="loader">
        <div class="line-scale-pulse-out">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>


<!-- Java Script
================================================== -->
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js"></script>
<script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/pose

    // the link to your poseModel provided by Teachable Machine export panel
    const POSE_URL = "/pose_model/";
    let poseModel, webcam, ctx, labelContainer, maxPredictions, webcamAnimation;

    async function poseInit() {
        const postModelUrl = POSE_URL + "model.json";
        const poseMetaUrl = POSE_URL + "metadata.json";

        // load the poseModel and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // Note: the pose library adds a tmPose object to your window (window.tmPose)
        poseModel = await tmPose.load(postModelUrl, poseMetaUrl);
        maxPredictions = poseModel.getTotalClasses();

        // Convenience function to setup a webcam
        const size = 200;
        const flip = true; // whether to flip the webcam
        webcam = new tmPose.Webcam(size, size, flip); // width, height, flip
        await webcam.setup(); // request access to the webcam
        await webcam.play();
        webcamAnimation = window.requestAnimationFrame(poseLoop);

        // append/get elements to the DOM
        const capture = document.getElementById("capture");
        capture.hidden = false;
        capture.width = size; capture.height = size;
        ctx = capture.getContext("2d");
        labelContainer = document.getElementById("pose-label-container");
        for (let i = 0; i < maxPredictions; i++) { // and class labels

            if (labelContainer.childNodes.length < 2) {
                labelLine = document.createElement('div');
                labelLine.className = 'label-line';

                labelBar = document.createElement("div");
                labelBar.className = "labelbar percentage percentage-1";

                labelText = document.createElement('span');
                labelText.className = 'label-text';
                labelLine.appendChild(labelText);
                labelLine.appendChild(labelBar);
                labelContainer.appendChild(labelLine);
            }
        }
    }

    async function poseLoop(timestamp) {
        webcam.update(); // update the webcam frame
        await posePredict();
        window.requestAnimationFrame(poseLoop);
    }

    function stopPose() {
        window.cancelAnimationFrame(webcamAnimation);
        document.getElementById('capture').hidden = true;
        webcam.stop();
    }

    async function posePredict() {
        // Prediction #1: run input through posenet
        // estimatePose can take in an image, video or canvas html element
        const { pose, posenetOutput } = await poseModel.estimatePose(webcam.canvas);
        // Prediction 2: run input through teachable machine classification poseModel
        const prediction = await poseModel.predict(posenetOutput);

        for (let i = 0; i < maxPredictions; i++) {
            let p = prediction[i].probability.toFixed(2) * 100;
            labelContainer.childNodes[i].childNodes[0].innerHTML = prediction[i].className + ' ( ' +  p + '% )';
            labelContainer.childNodes[i].childNodes[1].className = 'labelbar percentage percentage-' + p;
        }

        // finally draw the poses
        drawPose(pose);
    }

    function drawPose(pose) {
        if (webcam.canvas) {
            ctx.drawImage(webcam.canvas, 0, 0);
            // draw the keypoints and skeleton
            if (pose) {
                const minPartConfidence = 0.5;
                tmPose.drawKeypoints(pose.keypoints, minPartConfidence, ctx);
                tmPose.drawSkeleton(pose.keypoints, minPartConfidence, ctx);
            }
        }
    }
</script>
</body>

</html>
